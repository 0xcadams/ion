---
title: Nextjs
description: Reference for the `sst.aws.Nextjs` component.
---

import Segment from '../../../../../components/tsdoc/Segment.astro';
import Section from '../../../../../components/tsdoc/Section.astro';
import NestedTitle from '../../../../../components/tsdoc/NestedTitle.astro';
import InlineSection from '../../../../../components/tsdoc/InlineSection.astro';

<div class="tsdoc">

<Section type="about">
The `Nextjs` component lets you deploy Next.js apps on AWS. It uses
[OpenNext](https://open-next.js.org) to build your Next.js app, and transforms the build
output to a format that can be deployed to AWS.

#### Minimal example

Deploy the Next.js app that's in the project root.

```js
new sst.aws.Nextjs("Web");
```

#### Change the path

Deploys a Next.js app in the `my-next-app/` directory.

```js {2}
new sst.aws.Nextjs("Web", {
  path: "my-next-app/"
});
```

#### Add a custom domain

Set a custom domain for your Next.js app.

```js {2}
new sst.aws.Nextjs("Web", {
  domain: "my-app.com"
});
```

#### Redirect www to apex domain

Redirect `www.my-app.com` to `my-app.com`.

```js {4}
new sst.aws.Nextjs("Web", {
  domain: {
    domainName: "my-app.com",
    redirects: ["www.my-app.com"]
  }
});
```

#### Link resources

[Link resources](/docs/linking/) to your Next.js app. This will grant permissions
to the resources and allow you to access it in your app.

```ts {4}
const myBucket = new sst.aws.Bucket("MyBucket");

new sst.aws.Nextjs("Web", {
  link: [myBucket]
});
```

You can use the [Node client](/docs/reference/client/) to access the linked resources
in your Next.js app.

```ts title="app/page.tsx"
import { Resource } from "sst";

console.log(Resource.MyBucket.name);
```
</Section>

---

## Constructor

<Segment>
<Section type="signature">
```ts
new Nextjs(name, args, opts)
```
</Section>

<Section type="parameters">
#### Parameters
- <p><code class="key">name</code> <code class="primitive">string</code></p>
- <p><code class="key">args</code> [<code class="type">NextjsArgs</code>](#nextjsargs)</p>
- <p><code class="key">opts</code> [<code class="type">ComponentResourceOptions</code>](https://www.pulumi.com/docs/concepts/options/)</p>
</Section>
</Segment>

## Properties

### domainUrl
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Output</code><code class="symbol">&lt;</code><code class="primitive">undefined</code><code class="symbol"> | </code><code class="primitive">Output</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
If the `domain` is set, this is the URL of the Next.js app with the
custom domain.
</Segment>

### nodes
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code>
</InlineSection>
- <p>[<code class="key">assets</code>](#nodes-assets)</p>
- <p>[<code class="key">server</code>](#nodes-server)</p>
</Section>
The underlying [resources](/docs/components/#nodes) this component creates.
</Segment>
<NestedTitle id="nodes-assets" Tag="h4" parent="nodes.">assets</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** [<code class="type">Bucket</code>](bucket/)
</InlineSection>
</Section>
The Amazon S3 Bucket that stores the assets.
</Segment>
<NestedTitle id="nodes-server" Tag="h4" parent="nodes.">server</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** [<code class="type">Function</code>](function/)
</InlineSection>
</Section>
The AWS Lambda server function that renders the app.
</Segment>

### url
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Output</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
The autogenerated CloudFront URL of the Next.js app.
</Segment>

## Links

### url
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>
The autogenerated CloudFront URL of the Next.js app.
</Segment>

## NextjsArgs
### assets?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">Object</code><code class="symbol">&gt;</code>
</InlineSection>
- <p>[<code class="key">fileOptions?</code>](#assets-fileoptions) <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">Object</code><code class="symbol">[]</code><code class="symbol">&gt;</code></p>
  - <p>[<code class="key">cacheControl?</code>](#assets-fileoptions-cachecontrol)</p>
  - <p>[<code class="key">contentType?</code>](#assets-fileoptions-contenttype)</p>
  - <p>[<code class="key">files</code>](#assets-fileoptions-files)</p>
  - <p>[<code class="key">ignore?</code>](#assets-fileoptions-ignore)</p>
- <p>[<code class="key">nonVersionedFilesCacheHeader?</code>](#assets-nonversionedfilescacheheader)</p>
- <p>[<code class="key">textEncoding?</code>](#assets-textencoding)</p>
- <p>[<code class="key">versionedFilesCacheHeader?</code>](#assets-versionedfilescacheheader)</p>
</Section>
Configure how the Next.js app assets are uploaded to S3.

</Segment>
<NestedTitle id="assets-fileoptions" Tag="h4" parent="assets.">fileOptions?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">Object</code><code class="symbol">[]</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
Specify the `Content-Type` and `Cache-Control` headers for specific files. This allows
you to override the default behavior for specific files using glob patterns.

Apply `Cache-Control` and `Content-Type` to all zip files.
```js
{
  assets: {
    fileOptions: [
      {
        files: "**/*.zip",
        contentType: "application/zip",
        cacheControl: "private,no-cache,no-store,must-revalidate"
      },
    ],
  }
}
```
Apply `Cache-Control` to all CSS and JS files except for CSS files with `index-`
prefix in the `main/` directory.
```js
{
  assets: {
    fileOptions: [
      {
        files: ["**/*.css", "**/*.js"],
        ignore: "main/index-*.css",
        cacheControl: "private,no-cache,no-store,must-revalidate"
      },
    ],
  }
}
```
</Segment>
<NestedTitle id="assets-fileoptions-cachecontrol" Tag="h5" parent="assets.fileOptions[].">cacheControl?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>
The `Cache-Control` header to apply to the matched files.

</Segment>
<NestedTitle id="assets-fileoptions-contenttype" Tag="h5" parent="assets.fileOptions[].">contentType?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>
The `Content-Type` header to apply to the matched files.

</Segment>
<NestedTitle id="assets-fileoptions-files" Tag="h5" parent="assets.fileOptions[].">files</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code><code class="symbol"> | </code><code class="primitive">string</code><code class="symbol">[]</code>
</InlineSection>
</Section>
A glob pattern or array of glob patterns of files to apply these options to.

</Segment>
<NestedTitle id="assets-fileoptions-ignore" Tag="h5" parent="assets.fileOptions[].">ignore?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code><code class="symbol"> | </code><code class="primitive">string</code><code class="symbol">[]</code>
</InlineSection>
</Section>
A glob pattern or array of glob patterns of files to exclude from the ones matched
by the `files` glob pattern.

</Segment>
<NestedTitle id="assets-nonversionedfilescacheheader" Tag="h4" parent="assets.">nonVersionedFilesCacheHeader?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">"public,max-age=0,s-maxage=86400,stale-while-revalidate=8640"</code>
</InlineSection>
The `Cache-Control` header used for non-versioned files (like `main-1234.css`). This is
used by both CloudFront and the browser cache. The default `max-age` is set to 1 year.

```js
{
  assets: {
    nonVersionedFilesCacheHeader: "public,max-age=0,no-cache"
  }
}
```
</Segment>
<NestedTitle id="assets-textencoding" Tag="h4" parent="assets.">textEncoding?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="symbol">&ldquo;</code><code class="primitive">none</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">utf-8</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">iso-8859-1</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">windows-1252</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">ascii</code><code class="symbol">&rdquo;</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">"utf-8"</code>
</InlineSection>
Character encoding for text based assets uploaded to S3, like HTML, CSS, JS. This is
used to set the `Content-Type` header when these files are served out.

If set to `"none"`, then no charset will be returned in header.

```js
{
  assets: {
    textEncoding: "iso-8859-1"
  }
}
```
</Segment>
<NestedTitle id="assets-versionedfilescacheheader" Tag="h4" parent="assets.">versionedFilesCacheHeader?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">"public,max-age=31536000,immutable"</code>
</InlineSection>
The `Cache-Control` header used for versioned files (like `main-1234.css`). This is
used by both CloudFront and the browser cache. The default `max-age` is set to 1 year.

```js
{
  assets: {
    versionedFilesCacheHeader: "public,max-age=31536000,immutable"
  }
}
```
</Segment>
### buildCommand?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">"npx --yes open-next@OPEN_NEXT_VERSION build"</code>
</InlineSection>
The command used internally to build your Next.js app. It uses OpenNext with the `openNextVersion`.

If you want to use a custom `build` script from your `package.json`.
```js
{
  buildCommand: "npm run build"
}
```
</Segment>
### domain?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol"> | </code><code class="primitive">Object</code><code class="symbol">&gt;</code>
</InlineSection>
- <p>[<code class="key">aliases?</code>](#domain-aliases)</p>
- <p>[<code class="key">domainName</code>](#domain-domainname)</p>
- <p>[<code class="key">hostedZone?</code>](#domain-hostedzone)</p>
- <p>[<code class="key">hostedZoneId?</code>](#domain-hostedzoneid)</p>
- <p>[<code class="key">redirects?</code>](#domain-redirects)</p>
</Section>
Set a custom domain for your Next.js app. Supports domains hosted either on
[Route 53](https://aws.amazon.com/route53/) or outside AWS.

:::tip
You can also migrate an externally hosted domain to Amazon Route 53 by
[following this guide](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/MigratingDNS.html).
:::

```js
{
  domain: "domain.com"
}
```

Specify the Route 53 hosted zone and a `www.` version of the custom domain.

```js
{
  domain: {
    domainName: "domain.com",
    hostedZone: "domain.com",
    redirects: ["www.domain.com"]
  }
}
```
</Segment>
<NestedTitle id="domain-aliases" Tag="h4" parent="domain.">aliases?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">[]</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
Alias domains that should be used. Unlike the `redirect` option, this keeps your visitors
on this alias domain.

So if your users visit `app2.domain.com`, they will stay on `app2.domain.com` in their
browser.
```js {4}
{
  domain: {
    domainName: "app1.domain.com",
    aliases: ["app2.domain.com"]
  }
}
```
</Segment>
<NestedTitle id="domain-domainname" Tag="h4" parent="domain.">domainName</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
The custom domain you want to use. Supports domains hosted on [Route 53](https://aws.amazon.com/route53/) or outside AWS.

```js
{
  domain: "domain.com"
}
```
</Segment>
<NestedTitle id="domain-hostedzone" Tag="h4" parent="domain.">hostedZone?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** Same as the `domainName`
</InlineSection>
Name of the [Route 53 hosted zone](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/hosted-zones-working-with.html) that contains the `domainName`. You can find the hosted zone name in the Route 53 part of the AWS Console.


Usually your domain name is in a hosted zone with the same name. For example,
`domain.com` might be in a hosted zone also called `domain.com`. So by default, SST will
look for a hosted zone that matches the `domainName`.

There are cases where these might not be the same. For example, if you use a subdomain,
`app.domain.com`, the hosted zone might be `domain.com`. So you'll need to pass in the
hosted zone name.

:::note
If both the `hostedZone` and `hostedZoneId` are set, `hostedZoneId` will take precedence.
:::

```js {4}
{
  domain: {
    domainName: "app.domain.com",
    hostedZone: "domain.com"
  }
}
```
</Segment>
<NestedTitle id="domain-hostedzoneid" Tag="h4" parent="domain.">hostedZoneId?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
The 14 letter ID of the [Route 53 hosted zone](https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/hosted-zones-working-with.html) that contains the `domainName`. You can find the hosted zone ID in the Route 53 part of the AWS Console.

This option is useful for cases where you have multiple hosted zones that have the same
domain.

:::note
If both the `hostedZone` and `hostedZoneId` are set, `hostedZoneId` will take precedence.
:::

```js {4}
{
  domain: {
    domainName: "domain.com",
    hostedZoneId: "Z2FDTNDATAQYW2"
  }
}
```
</Segment>
<NestedTitle id="domain-redirects" Tag="h4" parent="domain.">redirects?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">[]</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
Alternate domains to be used. Visitors to the alternate domains will be redirected to the
main `domainName`.

:::note
Unlike the `aliases` option, this will redirect visitors back to the main `domainName`.
:::

Use this to create a `www.` version of your domain and redirect visitors to the apex domain.
```js {4}
{
  domain: {
    domainName: "domain.com",
    redirects: ["www.domain.com"]
  }
}
```
</Segment>
### environment?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code><code class="symbol">&gt;</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
Set [environment variables](https://nextjs.org/docs/pages/building-your-application/configuring/environment-variables) in your Next.js app. These are made available:

1. In `next build`, they are loaded into `process.env`.
2. Locally while running `sst dev next dev`.

:::tip
You can also `link` resources to your Next.js app and access them in a type-safe way with the [Node client](/docs/reference/client/). We recommend linking since it's more secure.
:::

Recall that in Next.js, you need to prefix your environment variables with `NEXT_PUBLIC_` to access these in the browser. [Read more here](https://nextjs.org/docs/pages/building-your-application/configuring/environment-variables#bundling-environment-variables-for-the-browser).

```js
{
  environment: {
    API_URL: api.url,
    // Accessible in the browser
    NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY: "pk_test_123"
  }
}
```
</Segment>
### imageOptimization?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code>
</InlineSection>
- <p>[<code class="key">memory?</code>](#imageoptimization-memory)</p>
</Section>

<InlineSection>
**Default** <code class="primitive">&lcub;memory: "1024 MB"&rcub;</code>
</InlineSection>
Configure the Lambda function used for image optimization.

</Segment>
<NestedTitle id="imageoptimization-memory" Tag="h4" parent="imageOptimization.">memory?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="symbol">&ldquo;</code><code class="primitive">$\{number\} MB</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">$\{number\} GB</code><code class="symbol">&rdquo;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">"1024 MB"</code>
</InlineSection>
The amount of memory allocated to the image optimization function.
Takes values between 128 MB and 10240 MB in 1 MB increments.

```js
{
  imageOptimization: {
    memory: "512 MB"
  }
}
```
</Segment>
### invalidation?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">Object</code><code class="symbol">&gt;</code>
</InlineSection>
- <p>[<code class="key">paths?</code>](#invalidation-paths)</p>
- <p>[<code class="key">wait?</code>](#invalidation-wait)</p>
</Section>

<InlineSection>
**Default** <code class="primitive">&lcub;paths: "all", wait: false&rcub;</code>
</InlineSection>
Configure how the CloudFront cache invalidations are handled. This is run after your Next.js app has been deployed.
:::tip
You get 1000 free invalidations per month. After that you pay $0.005 per invalidation path. [Read more here](https://aws.amazon.com/cloudfront/pricing/).
:::

Wait for all paths to be invalidated.
```js
{
  invalidation: {
    paths: "all",
    wait: true
  }
}
```
</Segment>
<NestedTitle id="invalidation-paths" Tag="h4" parent="invalidation.">paths?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">[]</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">none</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">all</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">versioned</code><code class="symbol">&rdquo;</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">"all"</code>
</InlineSection>
The paths to invalidate.

You can either pass in an array of glob patterns to invalidate specific files. Or you can use one of these built-in options:
- `none`: Nothing will be invalidated.
- `all`: All files will be invalidated when any file changes.
- `versioned`: Only versioned files will be invalidated when versioned files change.

:::note
Invalidating `all` counts as one invalidation, while each glob pattern counts as a single invalidation path.
:::

Disable invalidation.
```js
{
  invalidation: {
    paths: "none"
  }
}
```
Invalidate the `index.html` and all files under the `products/` route.
```js
{
  invalidation: {
    paths: ["/index.html", "/products/*"]
  }
}
```
</Segment>
<NestedTitle id="invalidation-wait" Tag="h4" parent="invalidation.">wait?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">boolean</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">false</code>
</InlineSection>
Configure if `sst deploy` should wait for the CloudFront cache invalidation to finish.

Waiting for the CloudFront cache invalidation process to finish ensures that the new content will be served once the deploy finishes. However, this process can sometimes take more than 5 mins. For non-prod environments it might make sense to pass in `false`. That'll skip waiting for the cache to invalidate and speed up the deploys.

```js
{
  invalidation: {
    wait: true
  }
}
```
</Segment>
### link?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">any</code><code class="symbol">[]</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
[Link resources](/docs/linking/) to your Next.js app. This will:

1. Grant the permissions needed to access the resources.
2. Allow you to access it in your site using the [Node client](/docs/reference/client/).

Takes a list of resources to link to the function.

```js
{
  link: [myBucket, stripeKey]
}
```
</Segment>
### logging?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="symbol">&ldquo;</code><code class="primitive">combined</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">per-route</code><code class="symbol">&rdquo;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">"per-route"</code>
</InlineSection>
Configure how the logs from your Next.js app are stored in Amazon CloudWatch.

CloudWatch sends all the logs to the same log group, `combined`. This
makes it hard to find the request you are looking for.

:::tip[SST Console]
With `per-route` logging enabled, the [Console](/docs/console/) will display each of
your routes separately on the resources screen.
:::

SST will instead split the logs from individual routes into different log groups,
`per-route`. The log group names are prefixed with `/sst/lambda/`, followed by the
server function name. It'll look something like `/sst/lambda/prod-app-MyNextSite-serverFunction6DFA6F1B-TiNQRV8IhGAu/979bddc4/about`.

```js
{
  logging: "combined"
}
```
</Segment>
### openNextVersion?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** The latest version of OpenNext
</InlineSection>
Configure the [OpenNext](https://open-next.js.org) version used to build the Next.js app.

:::note
This does not automatically update to the latest OpenNext version. It remains pinned to the version of SST you have.
:::

By default, this is pinned to the version of OpenNext that was released with the SST version you are using. You can [find this in the source](https://github.com/sst/ion/blob/dev/pkg/platform/src/components/aws/nextjs.ts) under `DEFAULT_OPEN_NEXT_VERSION`.

```js
{
  openNextVersion: "3.0.0-rc.3"
}
```
</Segment>
### path?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">"."</code>
</InlineSection>
Path to the directory where your Next.js app is located. This path is relative to your `sst.config.ts`.

By default this assumes your Next.js app is in the root of your SST app.

If your Next.js app is in a package in your monorepo.

```js
{
  path: "packages/web"
}
```
</Segment>
### permissions?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">Object</code><code class="symbol">[]</code><code class="symbol">&gt;</code>
</InlineSection>
- <p>[<code class="key">actions</code>](#permissions-actions)</p>
- <p>[<code class="key">resources</code>](#permissions-resources)</p>
</Section>
Permissions and the resources that the [server function](#nodes-server) in your Next.js app needs to access. These permissions are used to create the function's IAM role.

:::tip
If you `link` the function to a resource, the permissions to access it are
automatically added.
:::

Allow reading and writing to an S3 bucket called `my-bucket`.
```js
{
  permissions: [
    {
      actions: ["s3:GetObject", "s3:PutObject"],
      resources: ["arn:aws:s3:::my-bucket/*"]
    },
  ]
}
```

Perform all actions on an S3 bucket called `my-bucket`.

```js
{
  permissions: [
    {
      actions: ["s3:*"],
      resources: ["arn:aws:s3:::my-bucket/*"]
    },
  ]
}
```

Grant permissions to access all resources.

```js
{
  permissions: [
    {
      actions: ["*"],
      resources: ["*"]
    },
  ]
}
```
</Segment>
<NestedTitle id="permissions-actions" Tag="h4" parent="permissions[].">actions</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code><code class="symbol">[]</code>
</InlineSection>
</Section>
The [IAM actions](https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html#actions_table) that can be performed.

</Segment>
<NestedTitle id="permissions-resources" Tag="h4" parent="permissions[].">resources</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">string</code><code class="symbol">&gt;</code><code class="symbol">[]</code>
</InlineSection>
</Section>
The resources(s) specified using the [IAM ARN format](https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html).

</Segment>
### transform?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code>
</InlineSection>
- <p>[<code class="key">plan?</code>](#transform-plan) <code class="primitive">Object</code><code class="symbol"> | </code><code class="symbol">(</code><code class="primitive">args</code><code class="symbol">: </code><code class="primitive">Object</code><code class="symbol"> => </code><code class="primitive">Object</code><code class="symbol"> | </code><code class="primitive">void</code><code class="symbol">)</code></p>
  - <p>[<code class="key">behaviors</code>](#transform-plan-behaviors) <code class="primitive">Object</code><code class="symbol">[]</code></p>
    - <p>[<code class="key">allowedMethods?</code>](#transform-plan-behaviors-allowedmethods)</p>
    - <p>[<code class="key">cacheType</code>](#transform-plan-behaviors-cachetype)</p>
    - <p>[<code class="key">cfFunction?</code>](#transform-plan-behaviors-cffunction)</p>
    - <p>[<code class="key">edgeFunction?</code>](#transform-plan-behaviors-edgefunction)</p>
    - <p>[<code class="key">origin</code>](#transform-plan-behaviors-origin)</p>
    - <p>[<code class="key">pattern?</code>](#transform-plan-behaviors-pattern)</p>
  - <p>[<code class="key">buildId?</code>](#transform-plan-buildid)</p>
  - <p>[<code class="key">cloudFrontFunctions?</code>](#transform-plan-cloudfrontfunctions) <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">Object</code><code class="symbol">&gt;</code></p>
    - <p>[<code class="key">injections</code>](#transform-plan-cloudfrontfunctions-injections)</p>
  - <p>[<code class="key">edge</code>](#transform-plan-edge)</p>
  - <p>[<code class="key">edgeFunctions?</code>](#transform-plan-edgefunctions) <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">Object</code><code class="symbol">&gt;</code></p>
    - <p>[<code class="key">function</code>](#transform-plan-edgefunctions-function)</p>
  - <p>[<code class="key">errorResponses?</code>](#transform-plan-errorresponses)</p>
  - <p>[<code class="key">origins</code>](#transform-plan-origins) <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">Object</code><code class="symbol">&gt;</code></p>
    - <p>[<code class="key">group?</code>](#transform-plan-origins-group) <code class="primitive">Object</code></p>
      - <p>[<code class="key">fallbackOriginName</code>](#transform-plan-origins-group-fallbackoriginname)</p>
      - <p>[<code class="key">fallbackStatusCodes</code>](#transform-plan-origins-group-fallbackstatuscodes)</p>
      - <p>[<code class="key">primaryOriginName</code>](#transform-plan-origins-group-primaryoriginname)</p>
    - <p>[<code class="key">imageOptimization?</code>](#transform-plan-origins-imageoptimization) <code class="primitive">Object</code></p>
      - <p>[<code class="key">function</code>](#transform-plan-origins-imageoptimization-function)</p>
    - <p>[<code class="key">s3?</code>](#transform-plan-origins-s3) <code class="primitive">Object</code></p>
      - <p>[<code class="key">copy</code>](#transform-plan-origins-s3-copy) <code class="primitive">Object</code><code class="symbol">[]</code></p>
        - <p>[<code class="key">cached</code>](#transform-plan-origins-s3-copy-cached)</p>
        - <p>[<code class="key">from</code>](#transform-plan-origins-s3-copy-from)</p>
        - <p>[<code class="key">to</code>](#transform-plan-origins-s3-copy-to)</p>
        - <p>[<code class="key">versionedSubDir?</code>](#transform-plan-origins-s3-copy-versionedsubdir)</p>
      - <p>[<code class="key">originPath?</code>](#transform-plan-origins-s3-originpath)</p>
    - <p>[<code class="key">server?</code>](#transform-plan-origins-server) <code class="primitive">Object</code></p>
      - <p>[<code class="key">function</code>](#transform-plan-origins-server-function)</p>
      - <p>[<code class="key">injections?</code>](#transform-plan-origins-server-injections)</p>
      - <p>[<code class="key">streaming?</code>](#transform-plan-origins-server-streaming)</p>
  - <p>[<code class="key">serverCachePolicy?</code>](#transform-plan-servercachepolicy) <code class="primitive">Object</code></p>
    - <p>[<code class="key">allowedHeaders?</code>](#transform-plan-servercachepolicy-allowedheaders)</p>
</Section>
[Transform](/docs/components#transform/) how this component creates its underlying
resources.

</Segment>
<NestedTitle id="transform-plan" Tag="h4" parent="transform.">plan?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code><code class="symbol"> | </code><code class="symbol">(</code><code class="primitive">args</code><code class="symbol">: </code><code class="primitive">Object</code><code class="symbol"> => </code><code class="primitive">Object</code><code class="symbol"> | </code><code class="primitive">void</code><code class="symbol">)</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-behaviors" Tag="h5" parent="transform.plan.">behaviors</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code><code class="symbol">[]</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-behaviors-allowedmethods" Tag="h5" parent="transform.plan.behaviors[].">allowedMethods?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="symbol">(</code><code class="symbol">&ldquo;</code><code class="primitive">DELETE</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">GET</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">HEAD</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">OPTIONS</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">PATCH</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">POST</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">PUT</code><code class="symbol">&rdquo;</code><code class="symbol">)[]</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-behaviors-cachetype" Tag="h5" parent="transform.plan.behaviors[].">cacheType</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="symbol">&ldquo;</code><code class="primitive">server</code><code class="symbol">&rdquo;</code><code class="symbol"> | </code><code class="symbol">&ldquo;</code><code class="primitive">static</code><code class="symbol">&rdquo;</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-behaviors-cffunction" Tag="h5" parent="transform.plan.behaviors[].">cfFunction?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-behaviors-edgefunction" Tag="h5" parent="transform.plan.behaviors[].">edgeFunction?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-behaviors-origin" Tag="h5" parent="transform.plan.behaviors[].">origin</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-behaviors-pattern" Tag="h5" parent="transform.plan.behaviors[].">pattern?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-buildid" Tag="h5" parent="transform.plan.">buildId?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-cloudfrontfunctions" Tag="h5" parent="transform.plan.">cloudFrontFunctions?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">Object</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-cloudfrontfunctions-injections" Tag="h5" parent="transform.plan.cloudFrontFunctions[].">injections</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code><code class="symbol">[]</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-edge" Tag="h5" parent="transform.plan.">edge</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">boolean</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-edgefunctions" Tag="h5" parent="transform.plan.">edgeFunctions?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">Object</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-edgefunctions-function" Tag="h5" parent="transform.plan.edgeFunctions[].">function</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** [<code class="type">FunctionArgs</code>](function/#functionargs)
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-errorresponses" Tag="h5" parent="transform.plan.">errorResponses?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** [<code class="type">DistributionCustomErrorResponse</code>](https://www.pulumi.com/registry/packages/aws/api-docs/cloudfront/distribution/#distributioncustomerrorresponse)<code class="symbol">[]</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins" Tag="h5" parent="transform.plan.">origins</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Record</code><code class="symbol">&lt;</code><code class="primitive">string</code>, <code class="primitive">Object</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>
Each origin can be either an S3, server, image optimization, or group origin.

</Segment>
<NestedTitle id="transform-plan-origins-group" Tag="h5" parent="transform.plan.origins[].">group?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-group-fallbackoriginname" Tag="h5" parent="transform.plan.origins[].group.">fallbackOriginName</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-group-fallbackstatuscodes" Tag="h5" parent="transform.plan.origins[].group.">fallbackStatusCodes</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">number</code><code class="symbol">[]</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-group-primaryoriginname" Tag="h5" parent="transform.plan.origins[].group.">primaryOriginName</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-imageoptimization" Tag="h5" parent="transform.plan.origins[].">imageOptimization?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-imageoptimization-function" Tag="h5" parent="transform.plan.origins[].imageOptimization.">function</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** [<code class="type">FunctionArgs</code>](function/#functionargs)
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-s3" Tag="h5" parent="transform.plan.origins[].">s3?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-s3-copy" Tag="h5" parent="transform.plan.origins[].s3.">copy</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code><code class="symbol">[]</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-s3-copy-cached" Tag="h5" parent="transform.plan.origins[].s3.copy[].">cached</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">boolean</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-s3-copy-from" Tag="h5" parent="transform.plan.origins[].s3.copy[].">from</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-s3-copy-to" Tag="h5" parent="transform.plan.origins[].s3.copy[].">to</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-s3-copy-versionedsubdir" Tag="h5" parent="transform.plan.origins[].s3.copy[].">versionedSubDir?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-s3-originpath" Tag="h5" parent="transform.plan.origins[].s3.">originPath?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-server" Tag="h5" parent="transform.plan.origins[].">server?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-server-function" Tag="h5" parent="transform.plan.origins[].server.">function</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** [<code class="type">FunctionArgs</code>](function/#functionargs)
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-server-injections" Tag="h5" parent="transform.plan.origins[].server.">injections?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code><code class="symbol">[]</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-origins-server-streaming" Tag="h5" parent="transform.plan.origins[].server.">streaming?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">boolean</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-servercachepolicy" Tag="h5" parent="transform.plan.">serverCachePolicy?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Object</code>
</InlineSection>
</Section>

</Segment>
<NestedTitle id="transform-plan-servercachepolicy-allowedheaders" Tag="h5" parent="transform.plan.serverCachePolicy.">allowedHeaders?</NestedTitle>
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">string</code><code class="symbol">[]</code>
</InlineSection>
</Section>

</Segment>
### warm?
<Segment>
<Section type="parameters">
<InlineSection>
**Type** <code class="primitive">Input</code><code class="symbol">&lt;</code><code class="primitive">number</code><code class="symbol">&gt;</code>
</InlineSection>
</Section>

<InlineSection>
**Default** <code class="primitive">0</code>
</InlineSection>
The number of instances of the [server function](#nodes-server) to keep warm. This is useful for cases where you are experiencing long cold starts. The default is to not keep any instances warm.

This works by starting a serverless cron job to make _n_ concurrent requests to the server function every few minutes. Where _n_ is the number of instances to keep warm.

</Segment>
</div>